<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Simulador IVR</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .pantalla { background: #e0f7fa; height: 100px; border-radius: 10px; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; text-align: center; }
        .tecla { height: 60px; font-size: 1.5rem; font-weight: bold; }
    </style>
</head>
<body class="bg-dark d-flex justify-content-center align-items-center" style="height: 100vh;">

<div class="card" style="width: 350px; border-radius: 20px;">
    <div class="card-header text-center bg-warning">
        <h5 class="mb-0 fw-bold">IVR Simulator</h5>
    </div>
    <div class="card-body">

        <!-- Pantalla del teléfono -->
        <div id="pantallaTexto" class="pantalla mb-3 border p-2 text-primary">
            Marque una opción...
        </div>

        <!-- Teclado Numérico -->
        <div class="row g-2">
            <div class="col-4"><button onclick="enviar('1')" class="btn btn-light w-100 border tecla">1</button></div>
            <div class="col-4"><button onclick="enviar('2')" class="btn btn-light w-100 border tecla">2</button></div>
            <div class="col-4"><button onclick="enviar('3')" class="btn btn-light w-100 border tecla">3</button></div>

            <div class="col-4"><button onclick="enviar('4')" class="btn btn-light w-100 border tecla">4</button></div>
            <div class="col-4"><button onclick="enviar('5')" class="btn btn-light w-100 border tecla">5</button></div>
            <div class="col-4"><button onclick="enviar('6')" class="btn btn-light w-100 border tecla">6</button></div>

            <div class="col-12 mt-2">
                <button onclick="enviar('Inicio')" class="btn btn-success w-100 fw-bold">LLAMAR</button>
            </div>
        </div>

        <a href="/" class="btn btn-outline-secondary w-100 mt-3 btn-sm">Volver al Dashboard</a>
    </div>
</div>

<script>
    //para el controller
    function enviar(opcion) {
        const pantalla = document.getElementById("pantallaTexto");
        pantalla.innerText = "Procesando...";

        fetch('/api/ivr/responder', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ opcion: opcion })
        })
        .then(response => response.json())
        .then(data => {
            // Muestra la respuesta que viene del Strategy
            pantalla.innerText = data.respuesta;
        })
        .catch(error => {
            pantalla.innerText = "Error de conexión";
            console.error('Error:', error);
        });
    }
</script>
</body>
</html>